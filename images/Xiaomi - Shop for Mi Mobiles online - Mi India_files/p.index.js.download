function modalPlayVideo(e,t){var i=e.attr("data-video"),n=e.attr("data-video-title");if(i){var s="<iframe frameborder='0' allowfullscreen width='854' height='480' src='"+i+"' type='application/x-shockwave-flash' quality='high' align='middle'/></iframe>";return t.addClass("modal-video"),t.find(".modal-body").html(""),t.find(".modal-body").append(s),n&&t.find(".modal-header .title").text(n),t.modal("show").on("hidden",function(){t.removeClass("modal-video"),t.find(".modal-body").html(""),t.find(".modal-header .title").text("")}),!1}}!function(){function e(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(){return this?this.replace(t,function(t){return e[t]||t}):this}}function t(e,i,n){return("string"==typeof i?i:i.toString()).replace(e.define||r,function(t,i,s,o){return 0===i.indexOf("def.")&&(i=i.substring(4)),i in n||(":"===s?(e.defineParams&&o.replace(e.defineParams,function(e,t,s){n[i]={arg:t,text:s}}),i in n||(n[i]=o)):new Function("def","def['"+i+"']="+o)(n)),""}).replace(e.use||r,function(i,s){e.useParams&&(s=s.replace(e.useParams,function(e,t,i,s){if(n[i]&&n[i].arg&&s){var o=(i+":"+s).replace(/'|\\/g,"_");return n.__exp=n.__exp||{},n.__exp[o]=n[i].text.replace(new RegExp("(^|[^\\w$])"+n[i].arg+"([^\\w$])","g"),"$1"+s+"$2"),t+"def.__exp['"+o+"']"}}));var o=new Function("def","return "+s)(n);return o?t(e,o,n):o})}function i(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var n,s={version:"1.0.0",templateSettings:{evaluate:/\{\{([\s\S]+?\}?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1},template:void 0,compile:void 0};"undefined"!=typeof module&&module.exports?module.exports=s:"function"==typeof define&&define.amd?define("source/js/themes/pandora/_plugins/doT.js",[],function(){return s}):(n=function(){return this||(0,eval)("this")}(),n.doT=s),String.prototype.encodeHTML=e();var o={append:{start:"'+(",end:")+'",endencode:"||'').toString().encodeHTML()+'"},split:{start:"';out+=(",end:");out+='",endencode:"||'').toString().encodeHTML();out+='"}},r=/$^/;s.template=function(n,a,l){a=a||s.templateSettings;var d,c,u=a.append?o.append:o.split,g=0,p=a.use||a.define?t(a,n,l||{}):n;p=("var out='"+(a.strip?p.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):p).replace(/'|\\/g,"\\$&").replace(a.interpolate||r,function(e,t){return u.start+i(t)+u.end}).replace(a.encode||r,function(e,t){return d=!0,u.start+i(t)+u.endencode}).replace(a.conditional||r,function(e,t,n){return t?n?"';}else if("+i(n)+"){out+='":"';}else{out+='":n?"';if("+i(n)+"){out+='":"';}out+='"}).replace(a.iterate||r,function(e,t,n,s){return t?(g+=1,c=s||"i"+g,t=i(t),"';var arr"+g+"="+t+";if(arr"+g+"){var "+n+","+c+"=-1,l"+g+"=arr"+g+".length-1;while("+c+"<l"+g+"){"+n+"=arr"+g+"["+c+"+=1];out+='"):"';} } out+='"}).replace(a.evaluate||r,function(e,t){return"';"+i(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|\}|^|\{)out\+=''\+/g,"$1out+="),d&&a.selfcontained&&(p="String.prototype.encodeHTML=("+e.toString()+"());"+p);try{return new Function(a.varname,p)}catch(h){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+p),h}},s.compile=function(e,t){return s.template(e,null,t)}}(),function(e){var t={},n={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,slideZIndex:50,wrapperClass:"ui-wrapper",touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Previous",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,autoSlideForOnePage:!1,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:e.noop,onSlideBefore:e.noop,onSlideAfter:e.noop,onSlideNext:e.noop,onSlidePrev:e.noop,onSliderResize:e.noop};e.fn.slider=function(s){if(0==this.length)return this;if(this.length>1)return this.each(function(){e(this).slider(s)}),this;var o={},r=this;t.el=this;var a=e(window).width(),l=e(window).height(),d=function(){o.settings=e.extend({},n,s),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=r.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"==o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!=o.settings.mode&&function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in t)if(void 0!==e.style[t[i]])return o.cssPrefix=t[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"==o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),r.data("origStyle",r.attr("style")),r.children(o.settings.slideSelector).each(function(){e(this).data("origStyle",e(this).attr("style"))}),c()},c=function(){r.wrap('<div class="'+o.settings.wrapperClass+'"><div class="ui-viewport"></div></div>'),o.viewport=r.parent(),o.loader=e('<div class="ui-loading" />'),o.viewport.prepend(o.loader),r.css({width:"horizontal"==o.settings.mode?100*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?r.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing");v();o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:h()}),o.settings.pager||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"==o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",f()),"horizontal"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"==o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:o.settings.slideZIndex,display:"block"})),o.controls.el=e('<div class="ui-controls" />'),o.settings.captions&&P(),o.active.last=o.settings.startSlide==m()-1,o.settings.video&&r.fitVids();var t=o.children.eq(o.settings.startSlide);"all"==o.settings.preloadImages&&(t=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.pager&&C(),o.settings.controls&&$(),o.settings.auto&&o.settings.autoControls&&y(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),u(t,g)},u=function(t,i){var n=t.find("img, iframe").length;if(0==n)return void i();var s=0;t.find("img, iframe").each(function(){e(this).one("load",function(){++s==n&&i()}).each(function(){this.complete&&e(this).load()})})},g=function(){if(o.settings.infiniteLoop&&"fade"!=o.settings.mode&&!o.settings.ticker){var t="vertical"==o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,t).clone().addClass("ui-clone"),n=o.children.slice(-t).clone().addClass("ui-clone");r.append(i).prepend(n)}o.loader.remove(),x(),"vertical"==o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(p()),r.redrawSlider(),o.settings.onSliderLoad(o.active.index),o.initialized=!0,o.settings.responsive&&e(window).bind("resize",V),o.settings.auto&&o.settings.autoStart&&(m()>1||o.settings.autoSlideForOnePage)&&W(),o.settings.ticker&&A(),o.settings.pager&&q(o.settings.startSlide),o.settings.controls&&H(),o.settings.touchEnabled&&!o.settings.ticker&&D()},p=function(){var t=0,n=e();if("vertical"==o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var s=1==o.settings.moveSlides?o.active.index:o.active.index*S();for(n=o.children.eq(s),i=1;i<=o.settings.maxSlides-1;i++)n=s+i>=o.children.length?n.add(o.children.eq(i-1)):n.add(o.children.eq(s+i))}else n=o.children.eq(o.active.index);else n=o.children;return"vertical"==o.settings.mode?(n.each(function(i){t+=e(this).outerHeight()}),o.settings.slideMargin>0&&(t+=o.settings.slideMargin*(o.settings.minSlides-1))):t=Math.max.apply(Math,n.map(function(){return e(this).outerHeight(!1)}).get()),"border-box"==o.viewport.css("box-sizing")?t+=parseFloat(o.viewport.css("padding-top"))+parseFloat(o.viewport.css("padding-bottom"))+parseFloat(o.viewport.css("border-top-width"))+parseFloat(o.viewport.css("border-bottom-width")):"padding-box"==o.viewport.css("box-sizing")&&(t+=parseFloat(o.viewport.css("padding-top"))+parseFloat(o.viewport.css("padding-bottom"))),t},h=function(){var e="100%";return o.settings.slideWidth>0&&(e="horizontal"==o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),e},f=function(){var e=o.settings.slideWidth,t=o.viewport.width();return 0==o.settings.slideWidth||o.settings.slideWidth>t&&!o.carousel||"vertical"==o.settings.mode?e=t:o.settings.maxSlides>1&&"horizontal"==o.settings.mode&&(t>o.maxThreshold||t<o.minThreshold&&(e=(t-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides)),e},v=function(){var e=1;if("horizontal"==o.settings.mode&&o.settings.slideWidth>0)if(o.viewport.width()<o.minThreshold)e=o.settings.minSlides;else if(o.viewport.width()>o.maxThreshold)e=o.settings.maxSlides;else{var t=o.children.first().width()+o.settings.slideMargin;e=Math.floor((o.viewport.width()+o.settings.slideMargin)/t)}else"vertical"==o.settings.mode&&(e=o.settings.minSlides);return e},m=function(){var e=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)e=Math.ceil(o.children.length/S());else for(var t=0,i=0;t<o.children.length;)++e,t=i+v(),i+=o.settings.moveSlides<=v()?o.settings.moveSlides:v();else e=Math.ceil(o.children.length/v());return e},S=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=v()?o.settings.moveSlides:v()},x=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if("horizontal"==o.settings.mode){var e=o.children.last(),t=e.position();w(-(t.left-(o.viewport.width()-e.outerWidth())),"reset",0)}else if("vertical"==o.settings.mode){var i=o.children.length-o.settings.minSlides,t=o.children.eq(i).position();w(-t.top,"reset",0)}}else{var t=o.children.eq(o.active.index*S()).position();o.active.index==m()-1&&(o.active.last=!0),void 0!=t&&("horizontal"==o.settings.mode?w(-t.left,"reset",0):"vertical"==o.settings.mode&&w(-t.top,"reset",0))}},w=function(e,t,i,n){if(o.usingCSS){var s="vertical"==o.settings.mode?"translate3d(0, "+e+"px, 0)":"translate3d("+e+"px, 0, 0)";r.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==t?(r.css(o.animProp,s),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),M()})):"reset"==t?r.css(o.animProp,s):"ticker"==t&&(r.css("-"+o.cssPrefix+"-transition-timing-function","linear"),r.css(o.animProp,s),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),w(n.resetValue,"reset",0),L()}))}else{var a={};a[o.animProp]=e,"slide"==t?r.animate(a,i,o.settings.easing,function(){M()}):"reset"==t?r.css(o.animProp,e):"ticker"==t&&r.animate(a,speed,"linear",function(){w(n.resetValue,"reset",0),L()})}},b=function(){for(var t="",i=m(),n=0;i>n;n++){var s="";o.settings.buildPager&&e.isFunction(o.settings.buildPager)?(s=o.settings.buildPager(n),o.pagerEl.addClass("ui-custom-pager")):(s=n+1,o.pagerEl.addClass("ui-default-pager")),t+='<div class="ui-pager-item"><a href="" data-slide-index="'+n+'" class="ui-pager-link">'+s+"</a></div>"}o.pagerEl.html(t)},C=function(){o.settings.pagerCustom?o.pagerEl=e(o.settings.pagerCustom):(o.pagerEl=e('<div class="ui-pager" />'),o.settings.pagerSelector?e(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("ui-has-pager").append(o.pagerEl),b()),o.pagerEl.on("click","a",z)},$=function(){o.controls.next=e('<a class="ui-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=e('<a class="ui-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click",T),o.controls.prev.bind("click",k),o.settings.nextSelector&&e(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&e(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=e('<div class="ui-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("ui-has-controls-direction").append(o.controls.directionEl))},y=function(){o.controls.start=e('<div class="ui-controls-auto-item"><a class="ui-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=e('<div class="ui-controls-auto-item"><a class="ui-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=e('<div class="ui-controls-auto" />'),o.controls.autoEl.on("click",".ui-start",E),o.controls.autoEl.on("click",".ui-stop",_),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?e(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("ui-has-controls-auto").append(o.controls.autoEl),I(o.settings.autoStart?"stop":"start")},P=function(){o.children.each(function(t){var i=e(this).find("img:first").attr("title");void 0!=i&&(""+i).length&&e(this).append('<div class="ui-caption"><span>'+i+"</span></div>")})},T=function(e){o.settings.auto&&r.stopAuto(),r.goToNextSlide(),e.preventDefault()},k=function(e){o.settings.auto&&r.stopAuto(),r.goToPrevSlide(),e.preventDefault()},E=function(e){r.startAuto(),e.preventDefault()},_=function(e){r.stopAuto(),e.preventDefault()},z=function(t){o.settings.auto&&r.stopAuto();var i=e(t.currentTarget);if(void 0!==i.attr("data-slide-index")){var n=parseInt(i.attr("data-slide-index"));n!=o.active.index&&r.goToSlide(n),t.preventDefault()}},q=function(t){var i=o.children.length;return"short"==o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),void o.pagerEl.html(t+1+o.settings.pagerShortSeparator+i)):(o.pagerEl.find("a").removeClass("active"),void o.pagerEl.each(function(i,n){e(n).find("a").eq(t).addClass("active")}))},M=function(){if(o.settings.infiniteLoop){var e="";0==o.active.index?e=o.children.eq(0).position():o.active.index==m()-1&&o.carousel?e=o.children.eq((m()-1)*S()).position():o.active.index==o.children.length-1&&(e=o.children.eq(o.children.length-1).position()),e&&("horizontal"==o.settings.mode?w(-e.left,"reset",0):"vertical"==o.settings.mode&&w(-e.top,"reset",0))}o.working=!1,o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)},I=function(e){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[e]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.ui-"+e+")").addClass("active"))},H=function(){1==m()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0==o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index==m()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},W=function(){if(o.settings.autoDelay>0){setTimeout(r.startAuto,o.settings.autoDelay)}else r.startAuto();o.settings.autoHover&&r.hover(function(){o.interval&&(r.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(r.startAuto(!0),o.autoPaused=null)})},A=function(){var t=0;if("next"==o.settings.autoDirection)r.append(o.children.clone().addClass("ui-clone"));else{r.prepend(o.children.clone().addClass("ui-clone"));var i=o.children.first().position();t="horizontal"==o.settings.mode?-i.left:-i.top}w(t,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&!o.usingCSS&&o.viewport.hover(function(){r.stop()},function(){var t=0;o.children.each(function(i){t+="horizontal"==o.settings.mode?e(this).outerWidth(!0):e(this).outerHeight(!0)});var i=o.settings.speed/t,n="horizontal"==o.settings.mode?"left":"top",s=i*(t-Math.abs(parseInt(r.css(n))));L(s)}),L()},L=function(e){speed=e?e:o.settings.speed;var t={left:0,top:0},i={left:0,top:0};"next"==o.settings.autoDirection?t=r.find(".ui-clone").first().position():i=o.children.first().position();var n="horizontal"==o.settings.mode?-t.left:-t.top,s="horizontal"==o.settings.mode?-i.left:-i.top,a={resetValue:s};w(n,"ticker",speed,a)},D=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart",j)},j=function(e){if(o.working)e.preventDefault();else{o.touch.originalPos=r.position();var t=e.originalEvent;o.touch.start.x=t.changedTouches[0].pageX,o.touch.start.y=t.changedTouches[0].pageY,o.viewport.bind("touchmove",F),o.viewport.bind("touchend",R)}},F=function(e){var t=e.originalEvent,i=Math.abs(t.changedTouches[0].pageX-o.touch.start.x),n=Math.abs(t.changedTouches[0].pageY-o.touch.start.y);if(3*i>n&&o.settings.preventDefaultSwipeX?e.preventDefault():3*n>i&&o.settings.preventDefaultSwipeY&&e.preventDefault(),"fade"!=o.settings.mode&&o.settings.oneToOneTouch){var s=0;if("horizontal"==o.settings.mode){var r=t.changedTouches[0].pageX-o.touch.start.x;s=o.touch.originalPos.left+r}else{var r=t.changedTouches[0].pageY-o.touch.start.y;s=o.touch.originalPos.top+r}w(s,"reset",0)}},R=function(e){o.viewport.unbind("touchmove",F);var t=e.originalEvent,i=0;if(o.touch.end.x=t.changedTouches[0].pageX,o.touch.end.y=t.changedTouches[0].pageY,"fade"==o.settings.mode){var n=Math.abs(o.touch.start.x-o.touch.end.x);n>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto())}else{var n=0;"horizontal"==o.settings.mode?(n=o.touch.end.x-o.touch.start.x,i=o.touch.originalPos.left):(n=o.touch.end.y-o.touch.start.y,i=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0==o.active.index&&n>0||o.active.last&&0>n)?w(i,"reset",200):Math.abs(n)>=o.settings.swipeThreshold?(0>n?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto()):w(i,"reset",200)}o.viewport.unbind("touchend",R)},V=function(t){if(o.initialized){var i=e(window).width(),n=e(window).height();(a!=i||l!=n)&&(a=i,l=n,r.redrawSlider(),o.settings.onSliderResize.call(r,o.active.index))}};return r.goToSlide=function(t,i){if(!o.working&&o.active.index!=t)if(o.working=!0,o.oldIndex=o.active.index,0>t?o.active.index=m()-1:t>=m()?o.active.index=0:o.active.index=t,o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index),"next"==i?o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index):"prev"==i&&o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index),o.active.last=o.active.index>=m()-1,o.settings.pager&&q(o.active.index),o.settings.controls&&H(),"fade"==o.settings.mode)o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",o.settings.slideZIndex+1).fadeIn(o.settings.speed,function(){e(this).css("zIndex",o.settings.slideZIndex),M()});else{o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed);var n=0,s={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last)if("horizontal"==o.settings.mode){var a=o.children.eq(o.children.length-1);s=a.position(),n=o.viewport.width()-a.outerWidth()}else{var l=o.children.length-o.settings.minSlides;s=o.children.eq(l).position()}else if(o.carousel&&o.active.last&&"prev"==i){var d=1==o.settings.moveSlides?o.settings.maxSlides-S():(m()-1)*S()-(o.children.length-o.settings.maxSlides),a=r.children(".ui-clone").eq(d);s=a.position()}else if("next"==i&&0==o.active.index)s=r.find("> .ui-clone").eq(o.settings.maxSlides).position(),o.active.last=!1;else if(t>=0){var c=t*S();s=o.children.eq(c).position()}if("undefined"!=typeof s){var u="horizontal"==o.settings.mode?-(s.left-n):-s.top;w(u,"slide",o.settings.speed)}}},r.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var e=parseInt(o.active.index)+1;r.goToSlide(e,"next")}},r.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!=o.active.index){var e=parseInt(o.active.index)-1;r.goToSlide(e,"prev")}},r.startAuto=function(e){o.interval||(o.interval=setInterval(function(){"next"==o.settings.autoDirection?r.goToNextSlide():r.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&1!=e&&I("stop"))},r.stopAuto=function(e){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&1!=e&&I("start"))},r.getCurrentSlide=function(){return o.active.index},r.getCurrentSlideElement=function(){return o.children.eq(o.active.index)},r.getSlideCount=function(){return o.children.length},r.redrawSlider=function(){o.children.add(r.find(".ui-clone")).width(f()),o.viewport.css("height",p()),o.settings.ticker||x(),o.active.last&&(o.active.index=m()-1),o.active.index>=m()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(b(),q(o.active.index))},r.destroySlider=function(){o.initialized&&(o.initialized=!1,e(".ui-clone",this).remove(),o.children.each(function(){void 0!=e(this).data("origStyle")?e(this).attr("style",e(this).data("origStyle")):e(this).removeAttr("style")}),void 0!=e(this).data("origStyle")?this.attr("style",e(this).data("origStyle")):e(this).removeAttr("style"),e(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.settings.controls&&o.pagerEl.remove(),e(".ui-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&e(window).unbind("resize",V))},r.reloadSlider=function(e){void 0!=e&&(s=e),r.destroySlider(),d()},d(),this}}(jQuery),function(e){function t(t){function i(){p=S.itemPerSlide||Math.ceil(u.width()/h),v=Math.ceil(r.length/p),1>=v||(o(0),S.pager&&s(),S.auto&&(n(),S.controls&&a.find(".control").off(".carousel").on({"mouseenter.carousel":function(){w&&clearTimeout(w)},"mouseleave.carousel":function(){n()}}),S.pager&&g.find(".pager").off(".carousel").on({"mouseenter.carousel":function(){w&&clearTimeout(w)},"mouseleave.carousel":function(){n()}})))}function n(){return 0>=v?!1:(w&&clearInterval(w),void(w=setTimeout(function(){var e=b===v-1?0:b+1;o(e),n()},S.pause)))}function s(){for(var t='<ul class="xm-pagers">',i=0,n=v;n>i;i+=1)t+='<li class="pager'+(0===i?" pager-active":"")+'"><span class="dot">'+(i+1)+"</span></li>";t+="</ul>",g.html(t),g.find("li").off(".carousel").on("click.carousel",function(){e(this).addClass("pager-active").siblings().removeClass("pager-active"),o(g.find("li").index(e(this)))})}function o(e){return b===e?!1:(x.css({marginLeft:-h*S.itemPerSlide*e,transition:"margin-left "+S.speed/1e3+"s "+S.easing}),S.controls&&(0===e?l.addClass("control-disabled"):l.removeClass("control-disabled"),e===v-1?d.addClass("control-disabled"):d.removeClass("control-disabled")),S.pager&&g.find("li").eq(e).addClass("pager-active").siblings().removeClass("pager-active"),void(b=e))}var r,a,l,d,c,u,g,p,h,f,v,m,S,x=e(this),w=0,b=-1;return m={itemSelector:"> li",itemWidth:null,itemHeight:null,itemPerSlide:null,containerSelector:null,controlsSelector:null,pagersSelector:null,controls:!0,controlsClass:"xm-controls-line-small",pager:!1,speed:500,easing:"ease",auto:!1,pause:5e3,onLoad:e.noop},S=e.extend({},m,t),r=x.find(S.itemSelector),S.itemPerSlide&&r.length<=S.itemPerSlide?this:(h=S.itemWidth||r.outerWidth(!0),f=S.itemHeight||r.outerHeight(!0),c=S.containerSelector?x.closest(S.containerSelector):x.parent(),c.addClass("xm-carousel-container"),u=x.wrap('<div class="xm-carousel-wrapper"></div>').closest(".xm-carousel-wrapper").css({height:f,overflow:"hidden"}),x.css("width",h*r.length),S.controls&&(a=e('<div class="xm-controls '+S.controlsClass+' xm-carousel-controls"><a class="control control-prev iconfont" href="javascript: void(0);">&#xe90b;</a><a class="control control-next iconfont" href="javascript: void(0);">&#xe910;</a></div>'),S.controlsSelector?c.find(S.controlsSelector).append(a):a.insertAfter(u),l=a.find(".control-prev"),d=a.find(".control-next"),l.on("click",function(t){t.preventDefault(),e(this).hasClass("control-disabled")||o(b-1)}),d.on("click",function(t){t.preventDefault(),e(this).hasClass("control-disabled")||o(b+1)})),S.pager&&(g=e('<div class="xm-pagers-wrapper"></div>'),S.pagersSelector?c.find(S.pagersSelector).append(g):g.insertAfter(u)),void i())}e.fn.carousel=function(e){return this.each(function(){t.call(this,e)}),this}}(jQuery),function(e){function t(t){function i(){for(var t=-1,i=e(document).scrollTop(),n=0,s=d.length;s>n&&i+r.viewport.height()>d[n];n+=1)t+=1;return t}function n(){var t=i();l!==t&&(l=t,a.filter(function(t){return l>=t&&!e(this).hasClass(r.visibleClass)}).addClass(r.visibleClass).trigger("visible.visibleWatcher"),r.onVisible(a.eq(l),l))}function s(){a.each(function(){var t=e(this).attr("data-offset")?Number(e(this).attr("data-offset")):r.offset,i=t%1===0?t:t*r.viewport.height();d.push(e(this).offset().top+i)}),n(),r.onLoad()}var o,r,a=e(this),l=-1,d=[];o={viewport:e(window),visibleClass:"is-visible",offset:300,onLoad:e.noop,onVisible:e.noop},r=e.extend({},o,t),s(),r.viewport.on({"scroll.visibleWatcher":n,"resize.visibleWatcher":s})}e.fn.visibleWatcher=function(e){return t.call(this,e),this}}(jQuery),function(e){function t(){o=!1;for(var t=0,s=n.length;s>t;t++){var r=e(n[t]).filter(function(){return e(this).is(":appeared")});if(r.trigger("appear",[r]),i){var a=i.not(r);a.trigger("disappear",[a])}i=r}}var i,n=[],s=!1,o=!1,r={interval:250,force_process:!1},a=e(window);e.expr[":"].appeared=function(t){var i=e(t);if(!i.is(":visible"))return!1;var n=a.scrollLeft(),s=a.scrollTop(),o=i.offset(),r=o.left,l=o.top;return l+i.height()>=s&&l-(i.data("appear-top-offset")||0)<=s+a.height()&&r+i.width()>=n&&r-(i.data("appear-left-offset")||0)<=n+a.width()?!0:!1},e.fn.extend({appear:function(i){var a=e.extend({},r,i||{}),l=this.selector||this;if(!s){var d=function(){o||(o=!0,setTimeout(t,a.interval))};e(window).scroll(d).resize(d),s=!0}return a.force_process&&setTimeout(t,a.interval),n.push(l),e(l)}}),e.extend({force_appear:function(){return s?(t(),!0):!1}})}(jQuery),Xiaomi.prototype.miRecommend=function(e,t){function i(e){var t=l[o.type],i=Xiaomi.utils.cookie("userId"),s=Xiaomi.utils.cookie("mstuid"),r="?u="+s+"&i="+i+"&wsid="+o.wsid+"&num="+o.num+"&fh="+o.fh,a=o.apiHost[o.type]+r;o.cid&&(a+="&cid="+o.cid),$.ajax({dataType:"JSONP",url:a,jsonpCallback:t,cache:!0,params:o,success:function(t){if(t.type=this.params.type,t.title=this.params.title,t.global=xiaomi.globalConfig,t.isBuy=this.params.isBuy,this.params.deeper&&(t.r=t.r[0]),1===o.type)for(var i=0;i<xiaomi.globalConfig.damiaoGoodsId.length;i++)t.r=$.grep(t.r,function(e){return e.g!=parseInt(xiaomi.globalConfig.damiaoGoodsId[i])});if(t.r.length<o.recPerPage)return void o.wrapper.hide();if(o.slice){var s=t.r.length-t.r.length%o.recPerPage;t.r=t.r.slice(0,s)}t.r.length>0&&(t.r=$.map(t.r,function(e,t){return"id"===xiaomi.globalConfig.appLocal.name?e.p=Xiaomi.utils.formatPrice(e.p,"."):e.p=Xiaomi.utils.formatPrice(e.p),e}));var r=e,a=doT.template($("#miRecommendTemplate").html());r.html(a(t));var l=r.find("ul[data-carousel-list=true]").eq(0);n(r,l,this.params),null!==this.params.callback&&"function"==typeof this.params.callback&&this.params.callback(t)}})}function n(e,t,i){i.carousel&&t.carousel({itemPerSlide:o.recPerPage,containerSelector:e,controls:i.carouselControl,pager:i.carouselPage}),i.isBuy&&$(".J_xm-recommend-btn").on("click",function(e){e.preventDefault();var t=$(this),i=xiaomi.globalConfig.orderSite+"/cart/add/"+t.attr("data-gid");return xiaomi.cart().cartAdd(i,function(){location.href=xiaomi.globalConfig.orderSite+"/cart/"}),!1});var n=a.page[i.page],r=a.api[i.type];s(e,n,r),$.isFunction($("body").linkSign)&&e.linkSign({live:!0});var l=e.attr("id"),d="re-"+n+"."+r;$.force_appear(),e.appear(),e.one("appear",function(){"undefined"!=typeof _msq&&_msq.push(["trackPanelShow",l,d])})}function s(e,t,i){var n=e.find("a");$.each(n,function(e,n){var s,o=$(n).attr("data-stat-index"),r=d($(n).attr("data-stat-text")),a=$(n).attr("data-stat-method"),l=$(n).attr("data-stat-addcart");s=l?"stat_"+t+l+"."+i+"_"+o+"_"+a:"stat_"+t+"."+i+"_"+o+"_"+a,$(n).attr({"data-stat-pid":s,"data-stat-aid":r})})}this.options=t;var o,r={wsid:xiaomi.globalConfig.appLocal.xmst,type:1,gid:"1152300005",title:"",num:8,fh:0,apiHost:[xiaomi.globalConfig.recSite+"alsoview/get",xiaomi.globalConfig.recSite+"cartbuy/get",xiaomi.globalConfig.recSite+"guesslike/get",xiaomi.globalConfig.recSite+"accessory/get"],recPerPage:4,slice:!0,wrapper:null,page:"Cart",isBuy:!1,carousel:!0,carouselControl:!1,carouselPage:!0,callback:null,deeper:!1},a={page:{Home:"Home",Item:"Item",Cart:"Cart",PaySuccess:"PaySuccess",Search:"Search"},api:["AlsoView","AlsoBuy","JustForYou","Accessory"]},l=["recommend_alsoview","recommend_alsobuy","recommend_guesslike","recommend_accessory"],d=function(e){try{return e.replace(/\s/g,"")}catch(t){return e}};o=$.extend(r,t),o.wrapper=o.wrapper?o.wrapper:e,o.wrapper.show(),i(e)},$(document).ready(function(){function e(e){e.css("height","auto");var t=$(window).height()<700?700:$(window).height(),i=$(window).height()>1400?1400:t;e.css({height:i-150});var n=e.find(".J_slidePopImg"),s=$("#topSlide"),o=$("<img/>").attr("src",n.attr("src"));o[0].height,o[0].width,e.width(),e.height();e.css({width:s.width(),height:s.height()}),n.css({width:s.width(),height:s.height()}),e.find(".J_slidePopImg").css({"margin-left":-e.width()/2})}function t(e){e.parents(".ui-viewport").css("height","auto");var t=$(window).height()<700?700:$(window).height(),i=$(window).height()>1400?1400:t;e.css({height:i-150});var n=e.find(".slider").filter(function(e){return"none"!=$(this).css("display")?$(this):void 0}).find(".slide-image"),s=$("<img/>").attr("src",n.attr("src")),o=s[0].height,r=s[0].width,a=e.width(),l=e.height();r/o>=a/l?e.find(".slide-image").css({width:"auto",height:"100%"}):e.find(".slide-image").css({width:"100%",height:"auto"}),e.find(".slide-image").css({
"margin-left":-n.width()/2,"margin-top":-n.height()/2})}$(document).on("homeTop.slide",function(e,t){$("#J_shopCategories")[0].className="shop-categories "+t}),t($("#topSlide")),$("#topSlide .slider .slide-image").on("load",function(){t($("#topSlide"))}),$(window).on("resize",function(e){t($("#topSlide"))}),$(window).on("resize",function(t){e($("#slideVideoPop"))}),$("#topSlide").slider({mode:"fade",auto:!0,autoHover:!0,speed:800,ease:"ease-out",pause:5e3,onSliderLoad:function(e){var t=$("#topSlide .slider").eq(e).find(".txt").attr("data-color");$(document).trigger("homeTop.slide",t)},onSlideBefore:function(e,t,i){var n=$("#topSlide .slider");n.find(".txt").removeClass("enter leave"),n.eq(t).find(".txt").addClass("leave");var s=n.eq(i).find(".txt").addClass("enter").attr("data-color");$(document).trigger("homeTop.slide",s)}}),$("#mediaSlide").slider({mode:"fade",auto:!0,autoHover:!0,speed:800,ease:"ease-out",pause:5e3}),$(document).on("click",".J_video",function(e){e.preventDefault(),modalPlayVideo($(this),$("#home_videowrap"))}),$(document).on("click",".J_videoShow",function(e){e.preventDefault(),modalPlayVideo($(this),$("#slideVideoPop"));var t=$("#topSlide").outerHeight();$("#slideVideoPop").css({height:t})}),e($("#slideVideoPop"));var i=[];$(".J_homeAcc").on("visible.visibleWatcher",function(){if(!$(this).data("visible")){var e={page:"Home",type:3,fh:"1",num:"6",recPerPage:6,deeper:!0,wrapper:$(".J_homeAcc"),callbackName:"recommend_accessory",callback:function(e){i=e}};xiaomi.miRecommend($("#recHotAcc"),e),$(this).data("visible",!0)}}),$(".J_homeRec").on("visible.visibleWatcher",function(){if(!$(this).data("visible")){var e={page:"Home",type:2,fh:"1",slice:!1,num:"14",wrapper:$(".J_homeRec"),carousel:!1,callbackName:"recommend_guesslike",callback:function(e){var t=e,n=$("#recForYou .brick-list");if(i.r&&i.r.length>0){var s=[],o={};$.each(i.r,function(e,t){o[t.g]=!0}),$.each(t.r,function(e,t){o[t.g]&&s.push(t.g)}),$.each(s,function(e,t){n.find('> li[data-gid="'+t+'"]').remove()})}var r=n.find("> li").length;if(4>r)return void $(".J_homeRec").hide();for(var a=r>=8?8:4,l=r-1;l>=a;l--)n.find(">li").eq(l).remove();n.filter(function(){return $(this).find(">li").length>4}).carousel({itemPerSlide:4,containerSelector:$("#recForYou"),controls:!1,pager:!0})}};xiaomi.miRecommend($("#recForYou"),e),$(this).data("visible",!0)}}),$(".J_lazyRender").visibleWatcher({offset:-300});var n=$("#J_modalReview");n.length&&!Xiaomi.utils.cookie("redmi3sReview")&&(n.modal("show"),n.on("hide",function(){Xiaomi.utils.cookie("redmi3sReview","hide",{expires:7})}))});